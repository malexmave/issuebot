# -*- mode: python -*-

from twisted.application import service
from twisted.words.protocols.jabber import jid
from wokkel.client import XMPPClient
from twisted.internet.task import LoopingCall

import issuebot

### Configuration
# -- Change these values
# Jabber-ID
jabber_id = 'user@example.com'
# Password
password  = 'password'
# Room (including server)
room      = 'room@chat.example.com'
# Display name for the bot
bot_name  = 'Issuebot'
# Room Password (leave as None for no password)
room_pass = None
# Repository, in format 'username/repo'
repo      = 'octocat/Spoon-Knife'
# -- That's it, you're all set.

application = service.Application('issuebot')


client = XMPPClient(jid.internJID(jabber_id), password)

bot = issuebot.IssueBot(room, bot_name, None)
bot.setHandlerParent(client)

client.setServiceParent(application)

issuebot.Initialize(repo, bot)
lc = LoopingCall(issuebot.loop, (repo, bot))
lc.start(60)